---
title: "EDISON 2018: NONMEM estimation using R"
author: "Sungpil Han"
date: "`r Sys.Date()`"
knit: "bookdown::render_book"
documentclass: krantz
bibliography: ["bib/ref.bib", "bib/packages.bib"]
biblio-style: apalike
link-citations: yes
colorlinks: yes
lot: yes
lof: yes
fontsize: 12pt
monofont: "Source Code Pro"
monofontoptions: "Scale=0.7"
site: bookdown::bookdown_site
description: ""
url: 'https\://book-nmw.netlify.com/'
github-repo: asancpt/book-nmw
cover-image: assets/cover.jpg
output:
  bookdown::gitbook:
    df_print: kable
    dev: svglite
    css: style.css
    split_by: chapter
    config:
      toc:
        collapse: chapter
        before: |
          <li><a href="./index.html">NONMEM estimation using R</a></li>
        after: |
          <li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>
      #download: [pdf, epub, mobi]
      edit: https://github.com/rstudio/bookdown/edit/master/inst/examples/%s
      sharing:
        github: yes
        facebook: no
  bookdown::html_chapters:
    css: [css/style.css, css/toc.css]
  bookdown::pdf_book:
    includes:
      in_header: latex/preamble.tex
      before_body: latex/before_body.tex
      after_body: latex/after_body.tex
    keep_tex: yes
    dev: "cairo_pdf"
    latex_engine: xelatex
    citation_package: natbib
    template: null
    pandoc_args: --top-level-division=chapter
    toc_depth: 3
    toc_unnumbered: no
    toc_appendix: yes
    quote_footer: ["\\VA{", "}{}"]
  bookdown::epub_book:
    dev: svglite
    stylesheet: css/style.css
editor_options: 
  chunk_output_type: console
---

```{r setup, include = FALSE}
library(knitr)
opts_chunk$set(message = FALSE, warning = FALSE, error = TRUE)
```



# 계량약리학 초급

## nmw R package

NONMEM Workshop 2017에서 사용된 nmw 패키지입니다. [@Kim_2015;@Bae_2016;@R-nmw]

먼저 설치를 해야 합니다. 

```{r}
#install.packages(c('nmw', 'compiler')) # CRAN
library(nmw)
# library(compiler)
# enableJIT(3)
```

`THEO-FO.OUT`와 비교할 때 값이 같습니다.

Scaling factor는 소스 코드를 보고 알아낸 것입니다.

## Datasets

<!--```{r, code = readLines('lib/nmw/inst/doc/nmw-vignette.R'), cache = TRUE}
```-->

```{r}
DataAll = Theoph
colnames(DataAll) = c("ID", "BWT", "DOSE", "TIME", "DV")
DataAll[,"ID"] = as.numeric(as.character(DataAll[,"ID"]))
```

그림을 그려보면 다음과 같습니다. (Figure \@ref(fig:xyplot))

```{r xyplot, fig.cap = 'xyplot'}
require(lattice)
xyplot(DV ~ TIME | as.factor(ID), data=DataAll, type="b")
```
