<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>nmw</title>
  <meta name="description" content="A guide to authoring books with R Markdown, including how to generate figures and tables, and insert cross-references, citations, HTML widgets, and Shiny apps in R Markdown. The book can be exported to HTML, PDF, and e-books (e.g. EPUB). The book style is customizable. You can easily write and preview the book in RStudio IDE or other editors, and host the book wherever you want (e.g. bookdown.org).">
  <meta name="generator" content="bookdown 0.5.4 and GitBook 2.6.7">

  <meta property="og:title" content="nmw" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://wnl.netlify.com/" />
  <meta property="og:image" content="https://wnl.netlify.com/images/cover.jpg" />
  <meta property="og:description" content="A guide to authoring books with R Markdown, including how to generate figures and tables, and insert cross-references, citations, HTML widgets, and Shiny apps in R Markdown. The book can be exported to HTML, PDF, and e-books (e.g. EPUB). The book style is customizable. You can easily write and preview the book in RStudio IDE or other editors, and host the book wherever you want (e.g. bookdown.org)." />
  <meta name="github-repo" content="shanmdphd/wnl" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="nmw" />
  
  <meta name="twitter:description" content="A guide to authoring books with R Markdown, including how to generate figures and tables, and insert cross-references, citations, HTML widgets, and Shiny apps in R Markdown. The book can be exported to HTML, PDF, and e-books (e.g. EPUB). The book style is customizable. You can easily write and preview the book in RStudio IDE or other editors, and host the book wherever you want (e.g. bookdown.org)." />
  <meta name="twitter:image" content="https://wnl.netlify.com/images/cover.jpg" />

<meta name="author" content="Sungpil Han">


<meta name="date" content="2017-10-23">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="first-order-approximation-method.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css\style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">PKPD by R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> nmw 패키지</a></li>
<li class="chapter" data-level="2" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>2</b> 패키지를 사용한 예제</a><ul>
<li class="chapter" data-level="2.1" data-path="first-order-approximation-method.html"><a href="first-order-approximation-method.html"><i class="fa fa-check"></i><b>2.1</b> First Order Approximation Method</a><ul>
<li class="chapter" data-level="2.1.1" data-path="first-order-approximation-method.html"><a href="first-order-approximation-method.html#estres"><i class="fa fa-check"></i><b>2.1.1</b> EstRes</a></li>
<li class="chapter" data-level="2.1.2" data-path="first-order-approximation-method.html"><a href="first-order-approximation-method.html#covres"><i class="fa fa-check"></i><b>2.1.2</b> CovRes</a></li>
<li class="chapter" data-level="2.1.3" data-path="first-order-approximation-method.html"><a href="first-order-approximation-method.html#posthoceta"><i class="fa fa-check"></i><b>2.1.3</b> PostHocEta</a></li>
<li class="chapter" data-level="2.1.4" data-path="first-order-approximation-method.html"><a href="first-order-approximation-method.html#tabstep"><i class="fa fa-check"></i><b>2.1.4</b> TabStep</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="first-order-conditional-estimation-with-interaction-method.html"><a href="first-order-conditional-estimation-with-interaction-method.html"><i class="fa fa-check"></i><b>2.2</b> First Order Conditional Estimation with Interaction Method</a></li>
<li class="chapter" data-level="2.3" data-path="laplacian-approximation-with-interacton-method.html"><a href="laplacian-approximation-with-interacton-method.html"><i class="fa fa-check"></i><b>2.3</b> Laplacian Approximation with Interacton Method</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="-.html"><a href="-.html"><i class="fa fa-check"></i><b>3</b> 스크립트를 사용한 예제</a><ul>
<li class="chapter" data-level="3.1" data-path="fo-v2.html"><a href="fo-v2.html"><i class="fa fa-check"></i><b>3.1</b> FO v2</a></li>
<li class="chapter" data-level="3.2" data-path="focei-v2-1.html"><a href="focei-v2-1.html"><i class="fa fa-check"></i><b>3.2</b> FOCEI v2.1</a></li>
<li class="chapter" data-level="3.3" data-path="focei-v3.html"><a href="focei-v3.html"><i class="fa fa-check"></i><b>3.3</b> FOCEI v3</a></li>
<li class="chapter" data-level="3.4" data-path="lapli-v2-1.html"><a href="lapli-v2-1.html"><i class="fa fa-check"></i><b>3.4</b> LAPLI v2.1</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">nmw</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="examples" class="section level1">
<h1><span class="header-section-number">2</span> 패키지를 사용한 예제</h1>
<!--```{r, code = readLines('lib/nmw/inst/doc/nmw-vignette.R'), cache = TRUE}
```-->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">DataAll =<span class="st"> </span>Theoph
<span class="kw">colnames</span>(DataAll) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;BWT&quot;</span>, <span class="st">&quot;DOSE&quot;</span>, <span class="st">&quot;TIME&quot;</span>, <span class="st">&quot;DV&quot;</span>)
DataAll[,<span class="st">&quot;ID&quot;</span>] =<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">as.character</span>(DataAll[,<span class="st">&quot;ID&quot;</span>]))

<span class="kw">require</span>(lattice)</code></pre></div>
<pre><code>## Loading required package: lattice</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">xyplot</span>(DV <span class="op">~</span><span class="st"> </span>TIME <span class="op">|</span><span class="st"> </span><span class="kw">as.factor</span>(ID), <span class="dt">data=</span>DataAll, <span class="dt">type=</span><span class="st">&quot;b&quot;</span>)</code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-2-1.svg" width="672" /></p>
<p><span class="math inline">\(\theta, \eta, \epsilon\)</span> 개수를 먼저 지정해 주고 초기값을 설정합니다.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nTheta =<span class="st"> </span><span class="dv">3</span>
nEta =<span class="st"> </span><span class="dv">3</span>
nEps =<span class="st"> </span><span class="dv">2</span>

THETAinit =<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">50</span>, <span class="fl">0.1</span>)
OMinit =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>), <span class="dt">nrow=</span>nEta, <span class="dt">ncol=</span>nEta)
<span class="kw">data.frame</span>(OMinit)</code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">X1</th>
<th align="right">X2</th>
<th align="right">X3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.2</td>
<td align="right">0.1</td>
<td align="right">0.1</td>
</tr>
<tr class="even">
<td align="right">0.1</td>
<td align="right">0.2</td>
<td align="right">0.1</td>
</tr>
<tr class="odd">
<td align="right">0.1</td>
<td align="right">0.1</td>
<td align="right">0.2</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">SGinit =<span class="st"> </span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>))
<span class="kw">data.frame</span>(SGinit)</code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">X1</th>
<th align="right">X2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.1</td>
<td align="right">0.0</td>
</tr>
<tr class="even">
<td align="right">0.0</td>
<td align="right">0.1</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">LB =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, nTheta)
UB =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1000000</span>, nTheta)

FGD =<span class="st"> </span><span class="kw">deriv</span>(<span class="op">~</span>DOSE<span class="op">/</span>(TH2<span class="op">*</span><span class="kw">exp</span>(ETA2))<span class="op">*</span>TH1<span class="op">*</span><span class="kw">exp</span>(ETA1)<span class="op">/</span>(TH1<span class="op">*</span><span class="kw">exp</span>(ETA1) <span class="op">-</span><span class="st"> </span>TH3<span class="op">*</span><span class="kw">exp</span>(ETA3))<span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span>TH3<span class="op">*</span><span class="kw">exp</span>(ETA3)<span class="op">*</span>TIME)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>TH1<span class="op">*</span><span class="kw">exp</span>(ETA1)<span class="op">*</span>TIME)),
            <span class="kw">c</span>(<span class="st">&quot;ETA1&quot;</span>,<span class="st">&quot;ETA2&quot;</span>,<span class="st">&quot;ETA3&quot;</span>),
            <span class="dt">function.arg=</span><span class="kw">c</span>(<span class="st">&quot;TH1&quot;</span>, <span class="st">&quot;TH2&quot;</span>, <span class="st">&quot;TH3&quot;</span>, <span class="st">&quot;ETA1&quot;</span>, <span class="st">&quot;ETA2&quot;</span>, <span class="st">&quot;ETA3&quot;</span>, <span class="st">&quot;DOSE&quot;</span>, <span class="st">&quot;TIME&quot;</span>),
            <span class="dt">func=</span><span class="ot">TRUE</span>,
            <span class="dt">hessian=</span>(e<span class="op">$</span>METHOD <span class="op">==</span><span class="st"> &quot;LAPL&quot;</span>))
H =<span class="st"> </span><span class="kw">deriv</span>(<span class="op">~</span>F <span class="op">+</span><span class="st"> </span>F<span class="op">*</span>EPS1 <span class="op">+</span><span class="st"> </span>EPS2, <span class="kw">c</span>(<span class="st">&quot;EPS1&quot;</span>, <span class="st">&quot;EPS2&quot;</span>), <span class="dt">function.arg=</span><span class="kw">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;EPS1&quot;</span>, <span class="st">&quot;EPS2&quot;</span>), <span class="dt">func=</span><span class="ot">TRUE</span>)

PRED =<span class="st"> </span><span class="cf">function</span>(THETA, ETA, DATAi)
{
  FGDres =<span class="st"> </span><span class="kw">FGD</span>(THETA[<span class="dv">1</span>], THETA[<span class="dv">2</span>], THETA[<span class="dv">3</span>], ETA[<span class="dv">1</span>], ETA[<span class="dv">2</span>], ETA[<span class="dv">3</span>], <span class="dt">DOSE=</span><span class="dv">320</span>, DATAi[,<span class="st">&quot;TIME&quot;</span>])
  Gres =<span class="st"> </span><span class="kw">attr</span>(FGDres, <span class="st">&quot;gradient&quot;</span>)
  Hres =<span class="st"> </span><span class="kw">attr</span>(<span class="kw">H</span>(FGDres, <span class="dv">0</span>, <span class="dv">0</span>), <span class="st">&quot;gradient&quot;</span>)

  <span class="cf">if</span> (e<span class="op">$</span>METHOD <span class="op">==</span><span class="st"> &quot;LAPL&quot;</span>) {
    Dres =<span class="st"> </span><span class="kw">attr</span>(FGDres, <span class="st">&quot;hessian&quot;</span>)
    Res =<span class="st"> </span><span class="kw">cbind</span>(FGDres, Gres, Hres, Dres[,<span class="dv">1</span>,<span class="dv">1</span>], Dres[,<span class="dv">2</span>,<span class="dv">1</span>], Dres[,<span class="dv">2</span>,<span class="dv">2</span>], Dres[,<span class="dv">3</span>,])
    <span class="kw">colnames</span>(Res) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;G1&quot;</span>, <span class="st">&quot;G2&quot;</span>, <span class="st">&quot;G3&quot;</span>, <span class="st">&quot;H1&quot;</span>, <span class="st">&quot;H2&quot;</span>, <span class="st">&quot;D11&quot;</span>, <span class="st">&quot;D21&quot;</span>, <span class="st">&quot;D22&quot;</span>, <span class="st">&quot;D31&quot;</span>, <span class="st">&quot;D32&quot;</span>, <span class="st">&quot;D33&quot;</span>)
  } <span class="cf">else</span> {
    Res =<span class="st"> </span><span class="kw">cbind</span>(FGDres, Gres, Hres)
    <span class="kw">colnames</span>(Res) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;F&quot;</span>, <span class="st">&quot;G1&quot;</span>, <span class="st">&quot;G2&quot;</span>, <span class="st">&quot;G3&quot;</span>, <span class="st">&quot;H1&quot;</span>, <span class="st">&quot;H2&quot;</span>)
  }
  <span class="kw">return</span>(Res)
}</code></pre></div> 
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="first-order-approximation-method.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown/edit/master/inst/examples/index.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

<!-- </html> -->
