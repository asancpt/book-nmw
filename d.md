---
output: html_document
editor_options: 
  chunk_output_type: console
---


![](cover.jpg)

# NONMEM workshop 2017

- author: Sungpil Han, Kyun-Seop Bae
- date: 2017-02-22
- <https://github.com/asancpt/nmw2017edison>
- license: GPL-3

## Introduction

## Result

### Input Table



### Figure



![](xyplot.jpg)

### Method Calculation

- Dataset: Emax
- Method: LAPL


```r
########
PREDFILE <- ifelse(NMDataset == "Emax", "03-Emax/PRED.R", "04-THEO/PRED.R")

InitPara = InitStep(DataAll, THETAinit=THETAinit, OMinit=OMinit, SGinit=SGinit, 
                    nTheta=nTheta, LB=LB, UB=UB, METHOD=METHOD, PredFile=PREDFILE)

(EstRes = EstStep())           # 0.6200359 secs, 0.4930282 secs
```

```
## $`Initial OFV`
## [1] 20011.59
## 
## $Time
## Time difference of 10.08711 secs
## 
## $Optim
## $Optim$par
## [1] -1.0501146 -0.1350324 -1.6319945  1.1015540
## 
## $Optim$value
## [1] 219.1097
## 
## $Optim$counts
## function gradient 
##       54       54 
## 
## $Optim$convergence
## [1] 0
## 
## $Optim$message
## [1] "CONVERGENCE: REL_REDUCTION_OF_F <= FACTR*EPSMCH"
## 
## $Optim$hessian
##             [,1]         [,2]      [,3]        [,4]
## [1,]  656.391707 2.112855e+03 -1.796362   1.7589136
## [2,] 2112.855408 8.523999e+04  3.011961   0.5139452
## [3,]   -1.796362 3.011961e+00  4.228184   3.9976838
## [4,]    1.758914 5.139452e-01  3.997684 275.7848643
## 
## 
## $`Final Estimates`
## [1]  3.166026403 79.056181424  0.006260927  7.412056839
```

```r
(CovRes = CovStep())
```

```
## $Time
## Time difference of 1.466418 secs
## 
## $`Standard Error`
## [1] 0.220422217 0.409550974 0.005474408 1.269827834
## 
## $`Covariance Matrix of Estimates`
##               [,1]          [,2]          [,3]        [,4]
## [1,]  0.0485859535 -0.0789257787 -3.799125e-04 0.072281620
## [2,] -0.0789257787  0.1677320006 -1.977460e-05 0.012827930
## [3,] -0.0003799125 -0.0000197746  2.996915e-05 0.001578315
## [4,]  0.0722816198  0.0128279301  1.578315e-03 1.612462729
## 
## $`Correlation Matrix of Estimates`
##            [,1]         [,2]         [,3]       [,4]
## [1,]  1.0000000 -0.874290071 -0.314840791 0.25824247
## [2,] -0.8742901  1.000000000 -0.008819878 0.02466629
## [3,] -0.3148408 -0.008819878  1.000000000 0.22704478
## [4,]  0.2582425  0.024666287  0.227044783 1.00000000
## 
## $`Inverse Covariance Matrix of Estimates`
##           [,1]        [,2]       [,3]         [,4]
## [1,]  17115196   8171247.4  280653761  -1106936.70
## [2,]   8171247   3901175.7  133991540   -528480.93
## [3,] 280653761 133991539.7 4602175592 -18151503.70
## [4,]  -1106937   -528480.9  -18151504     71592.52
## 
## $`Eigen Values`
## [1] 5.749535e-07 8.330777e-01 1.225585e+00 1.941337e+00
## 
## $`R Matrix`
##              [,1]         [,2]         [,3]         [,4]
## [1,]  32.16246987 4.2320295296   -21.487947 7.679714e-02
## [2,]   4.23202953 6.8196360996     1.550535 8.464139e-04
## [3,] -21.48794694 1.5505347433 13479.902358 1.074944e+01
## [4,]   0.07679714 0.0008464139    10.749436 5.880076e-01
## 
## $`S Matrix`
##             [,1]        [,2]       [,3]       [,4]
## [1,]   32.689280  -7.2209445 -175.87338  1.4077642
## [2,]   -7.220944   4.1105643  -10.16234  0.1904331
## [3,] -175.873380 -10.1623435 6303.74012 25.9912735
## [4,]    1.407764   0.1904331   25.99127  0.5871185
```

```r
PostHocEta() # FinalPara from EstStep()
```

```
##      ID         ETA1
## [1,]  1 -0.086421925
## [2,]  2 -0.005285026
## [3,]  3  0.021540797
## [4,]  4  0.070107560
```

```r
get("EBE", envir=e)
```

```
##      ID         ETA1
## [1,]  1 -0.086421925
## [2,]  2 -0.005285026
## [3,]  3  0.021540797
## [4,]  4  0.070107560
```
